metadata:
  name: "Ensure every Elastic IP is associated with a resource and public EIPs are only associated with load balancers"
  id: "CKV_CUSTOM_2"
  severity: "HIGH"
  category: "NETWORKING"
definition:
  and:
    - cond_type: filter
      attribute: resource_type
      value:
        - aws_eip
      operator: within
    - cond_type: attribute
      resource_types:
        - aws_eip
      attribute: "instance"
      operator: exists
    - cond_type: attribute
      resource_types:
        - aws_eip
      attribute: "public_ip"
      operator: exists
    - cond_type: connection
      resource_types:
        - aws_eip
      connected_resource_types:
        - aws_elb
      operator: exists
