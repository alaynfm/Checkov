---
metadata:
  id: "CKV_CUSTOM_1"
  name: "Ensure PostgreSQL RDS instances have PGAudit enabled"
  category: "Security"
  severity: "HIGH"
  description: "Ensures that PostgreSQL RDS instances have the PGAudit extension enabled by verifying that the pgaudit.log parameter is set in the DB parameter group."

definition:
  all_of:
    - cond_type: "attribute"
      resource_types:
        - "aws_db_parameter_group"
      attribute: "parameter"
      sub_attribute: "name"
      operator: "equals"
      value: "shared_preload_libraries"
    - cond_type: "attribute"
      resource_types:
        - "aws_db_parameter_group"
      attribute: "parameter"
      sub_attribute: "value"
      operator: "equals"
      value: "pgaudit"

